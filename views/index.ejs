<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/styles.css">
    <title>하버마스의 공론장</title>
</head>
<body>
    <h1>하버마스의 공론장</h1>
    <h2>토론 주제 목록</h2>
    <form id="topicForm">
        <input type="text" name="title" placeholder="새로운 주제를 입력하세요" required>
        <button type="submit">추가</button>
    </form>
    <ul id="topicList">
        <% topics.forEach((topic, index) => { %>
            <li><a href="/topic/<%= index %>"><%= topic.title %></a></li>
        <% }); %>
    </ul>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();

        socket.on('topicAdded', (newTopic) => {
            const topicList = document.getElementById('topicList');
            const li = document.createElement('li');
            li.innerHTML = `<a href="/topic/${topics.length}">${newTopic.title}</a>`;
            topicList.appendChild(li);
        });

        document.getElementById('topicForm').addEventListener('submit', (event) => {
            event.preventDefault();
            const formData = new FormData(event.target);
            const title = formData.get('title');

            fetch('/add-topic', {
                method: 'POST',
                body: new URLSearchParams({ title })
            });
            event.target.reset();
        });
    </script>
</body>
</html>
